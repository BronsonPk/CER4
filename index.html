<!DOCTYPE html>
<html>
<head>
    <title>Paris Olympic Opening Ceremony Transportation Planner</title>
    <!-- ... (previous head content remains the same) ... -->
</head>
<body>
    <div class="container">
        <!-- ... (previous body content remains the same) ... -->
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script>
        // ... (previous JavaScript code remains the same) ...

        function calculateRoute() {
            // ... (previous code remains the same) ...

            if (selectedHotel && selectedVenue) {
                // ... (previous code remains the same) ...

                if (psa && psa.location) {
                    // ... (previous code remains the same) ...

                    const hotelToPSARenderer = new google.maps.DirectionsRenderer({
                        polylineOptions: {
                            strokeColor: 'blue'
                        },
                        suppressMarkers: true
                    });
                    const psaToVenueRenderer = new google.maps.DirectionsRenderer({
                        polylineOptions: {
                            strokeColor: 'green'
                        },
                        suppressMarkers: true
                    });

                    // ... (previous code remains the same) ...

                    directionsService.route(hotelToPSARequest, function(hotelToPSAResult, hotelToPSAStatus) {
                        if (hotelToPSAStatus === 'OK') {
                            hotelToPSARenderer.setDirections(hotelToPSAResult);
                            hotelToPSARenderer.setMap(map);

                            directionsService.route(psaToVenueRequest, function(psaToVenueResult, psaToVenueStatus) {
                                if (psaToVenueStatus === 'OK') {
                                    psaToVenueRenderer.setDirections(psaToVenueResult);
                                    psaToVenueRenderer.setMap(map);

                                    // ... (previous code remains the same) ...

                                    // Display turn-by-turn directions
                                    const combinedDirections = {
                                        routes: [
                                            {
                                                legs: [
                                                    ...hotelToPSAResult.routes[0].legs,
                                                    ...psaToVenueResult.routes[0].legs
                                                ]
                                            }
                                        ]
                                    };
                                    directionsRenderer.setDirections(combinedDirections);
                                } else {
                                    console.error('Error calculating PSA to Venue route:', psaToVenueStatus);
                                }
                            });
                        } else {
                            console.error('Error calculating Hotel to PSA route:', hotelToPSAStatus);
                        }
                    });
                } else {
                    console.error('Nearest PSA not found or missing location data');
                }
            }
        }

        function formatDuration(durationInSeconds) {
            // ... (previous code remains the same) ...
        }
    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBjlGkxN5JMqjBQn0Tb0HY-3hG8ACkITuM&libraries=geometry,drawing&callback=initMap" async defer></script>
</body>
</html>
